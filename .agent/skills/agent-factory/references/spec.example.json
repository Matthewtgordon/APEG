{
  "project": {
    "name": "ExampleProject",
    "updated": "2025-01-05",
    "one_liner": "ExampleProject is a demo service for agent file generation.",
    "stack": {
      "language": "Python",
      "version": "3.11",
      "framework": "FastAPI",
      "database": "SQLite"
    },
    "architecture": "Async API + Worker"
  },
  "agents": {
    "autonomy_mode": "FULL",
    "always": [
      "Use .venv/bin/python when .venv exists",
      "Use repository-relative paths in responses",
      "Run test.smoke after every code change"
    ],
    "ask_first": [
      "Adding new dependencies to requirements.txt",
      "Modifying database schema"
    ],
    "never": [
      "Commit secrets or credentials",
      "Delete existing tests"
    ],
    "key_files": [
      {
        "purpose": "Entry point",
        "path": "src/main.py"
      },
      {
        "purpose": "API routes",
        "path": "src/api/routes.py"
      },
      {
        "purpose": "Tests",
        "path": "tests/"
      }
    ]
  },
  "context": {
    "generated": "2025-01-05 14:30Z",
    "immediate_action": "Add request validation to the create endpoint",
    "immediate_file": "src/api/routes.py",
    "immediate_why": "Missing validation caused 400s in production",
    "execplan_path": ".agent/plans/EXECPLAN-P1-validation.md",
    "last_checkpoint": "2025-01-05 12:00Z",
    "phase": "1",
    "phase_name": "API",
    "status": "IN_PROGRESS",
    "constraints": [
      "Do not add GPL dependencies",
      "Do not bypass auth checks"
    ],
    "blockers": [
      "None"
    ],
    "preflight": {
      "cwd": "/path/to/ExampleProject",
      "interpreter": "/path/to/ExampleProject/.venv/bin/python",
      "python_version": "3.11",
      "venv_active": "true",
      "env_exists": "false",
      "git_status": "clean",
      "branch": "main",
      "test_cmd_found": "true",
      "secrets_mode": "SKIP",
      "safe_mock_ok": "false",
      "last_preflight": "2025-01-05 14:00Z"
    },
    "scope": {
      "goal": "Add validation to create endpoint",
      "non_goals": "No schema changes",
      "risk_level": "LOW",
      "test_plan": "test.smoke"
    },
    "pending_inputs": [
      {
        "question": "Need live API key?",
        "needed_for": "integration tests"
      }
    ]
  },
  "runbook": {
    "metadata": {
      "repo_root": "/path/to/ExampleProject",
      "shell": "bash",
      "env_file": ".env"
    },
    "commands": [
      {
        "id": "run",
        "action": "Start dev server",
        "command": "PYTHONPATH=. .venv/bin/python -m uvicorn src.main:app --reload --port 8000",
        "preconditions": "deps installed",
        "expected": "Uvicorn running"
      },
      {
        "id": "lint",
        "action": "Lint source",
        "command": ".venv/bin/python -m ruff check src/",
        "preconditions": "deps installed",
        "expected": "No lint errors"
      }
    ],
    "command_args": [
      {
        "id": "test.single",
        "args": "{PATH}",
        "example": "PYTHONPATH=. .venv/bin/python -m pytest tests/unit/test_api.py -v"
      }
    ],
    "test_tiers": [
      {
        "tier": "SMOKE",
        "id": "test.smoke",
        "command": "PYTHONPATH=. .venv/bin/python -m pytest tests/unit/ -v",
        "preconditions": "deps installed",
        "fallback": "ASK"
      },
      {
        "tier": "TARGETED",
        "id": "test.targeted",
        "command": "PYTHONPATH=. .venv/bin/python -m pytest tests/ -k {MODULE} -v",
        "preconditions": "deps installed",
        "fallback": "Run test.smoke"
      },
      {
        "tier": "FULL",
        "id": "test.full",
        "command": "PYTHONPATH=. .venv/bin/python -m pytest -v",
        "preconditions": "deps + .env",
        "fallback": "Run test.smoke and warn"
      }
    ],
    "environment_modes": [
      {
        "mode": "LIVE",
        "condition": ".env exists",
        "behavior": "Run all tests"
      },
      {
        "mode": "MOCK",
        "condition": "SAFE_MOCK_OK=true",
        "behavior": "Use mock fixtures"
      },
      {
        "mode": "SKIP",
        "condition": "no .env",
        "behavior": "Skip integration"
      }
    ],
    "phase_scripts": [
      {
        "phase": "1",
        "script": "scripts/migrate.py",
        "command": "PYTHONPATH=. .venv/bin/python scripts/migrate.py --dry-run",
        "preconditions": "db reachable",
        "expected": "Migration plan printed"
      }
    ],
    "troubleshooting": [
      {
        "pattern": "(Connection refused|ECONNREFUSED)",
        "diagnosis": "Service not running",
        "next_command": "python -c \"import socket; s=socket.socket(); s.connect(('127.0.0.1',8000))\""
      }
    ],
    "integration_checks": [
      {
        "id": "healthcheck",
        "purpose": "Verify service responds",
        "command": "curl -s http://localhost:8000/health",
        "expected": "HTTP 200 and JSON response",
        "evidence": "Response body"
      }
    ]
  },
  "status": {
    "updated": "2025-01-05",
    "phases": [
      {
        "phase": "0",
        "name": "Bootstrap",
        "status": "COMPLETE",
        "goal": "Project scaffolding complete",
        "evidence": "docs/ACCEPTANCE_TESTS.md#P0"
      },
      {
        "phase": "1",
        "name": "API",
        "status": "IN_PROGRESS",
        "goal": "API stable and validated",
        "evidence": "docs/ACCEPTANCE_TESTS.md#P1"
      }
    ],
    "current_phase": {
      "phase": "1",
      "name": "API",
      "goal": "Requests validated and error handling consistent",
      "objectives": [
        "Add request validation",
        "Normalize error responses"
      ],
      "evidence": [
        "docs/ACCEPTANCE_TESTS.md#P1"
      ],
      "risks": [
        "Validation logic duplicated in handlers"
      ],
      "blockers": [
        "None"
      ]
    }
  },
  "skills": [
    {
      "name": "pdf-reporting",
      "title": "PDF Reporting",
      "description": "Generate PDF reports and fill templates. Use when user asks to create or update PDF reports, populate forms, or extract tables.",
      "overview": "Produce PDF outputs from structured data and templates.",
      "triggers": [
        "create PDF report",
        "fill PDF form",
        "extract PDF table"
      ],
      "quick_start": {
        "command": "python3 scripts/render_report.py input.json output.pdf",
        "expected": "Report written to output.pdf"
      },
      "inputs": {
        "inputs": [
          "input.json",
          "report template"
        ],
        "outputs": [
          "output.pdf"
        ],
        "preconditions": "templates present"
      },
      "scripts": [
        {
          "path": "scripts/render_report.py",
          "purpose": "Render a PDF report",
          "command": "python3 scripts/render_report.py <input> <output>",
          "args": "<input> <output>",
          "expected": "PDF created"
        }
      ],
      "examples": [
        {
          "name": "Render report",
          "command": "python3 scripts/render_report.py input.json report.pdf",
          "output": "Report written to report.pdf"
        }
      ],
      "references": [
        {
          "file": "references/templates.md",
          "when": "template selection or layout rules needed"
        }
      ]
    }
  ],
  "system_instruction": {
    "path": "System_Instruction_Candidate.md",
    "kb_templates": [
      "template-agents-md.md",
      "template-governance-md.md",
      "template-context-md.md",
      "template-plans-md.md",
      "template-runbook-md.md",
      "template-project-status-md.md",
      "template-skill-md.md"
    ]
  }
}
